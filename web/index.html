<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Games List Manager</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <div class="app-header__title-block">
          <h1 class="app-header__title">Games List Manager</h1>
          <span class="app-header__version">v0.0.0</span>
        </div>
        <p class="app-header__description">
          Удобный инструмент для локального управления статусами прохождения игр
        </p>
      </header>

      <div class="topbar">
        <div class="topbar__left">
          <button
            id="add-game-btn"
            class="btn btn--primary btn--icon-left"
            data-icon="+"
          >
            Добавить игру
          </button>

          <div class="stats">
            <button class="stats__item stats__item--active" data-filter="all">
              <span class="stats__count" id="total-games">0</span>
              <span class="stats__label">Всего</span>
            </button>
            <button class="stats__item" data-filter="playing">
              <span class="stats__count" id="playing-games">0</span>
              <span class="stats__label">Играю</span>
            </button>
            <button class="stats__item" data-filter="planned">
              <span class="stats__count" id="planned-games">0</span>
              <span class="stats__label">В планах</span>
            </button>
            <button class="stats__item" data-filter="completed">
              <span class="stats__count" id="completed-games">0</span>
              <span class="stats__label">Пройдено</span>
            </button>
            <button class="stats__item" data-filter="dropped">
              <span class="stats__count" id="dropped-games">0</span>
              <span class="stats__label">Дропнул</span>
            </button>
          </div>
        </div>

        <div class="topbar__right">
          <select id="sort-select" class="select">
            <option value="rating-desc">По оценке</option>
            <option value="title-asc">По названию</option>
            <option value="added-desc">По дате добавления</option>
            <option value="added-asc">По дате обновления</option>
          </select>
          <input
            id="search"
            type="search"
            class="search"
            placeholder="Поиск по названию..."
          />
        </div>
      </div>

      <main class="content">
        <div id="games-list" class="games-list"></div>
      </main>
    </div>

    <!-- Модальное окно формы -->
    <div id="game-modal" class="modal" aria-hidden="true">
      <div class="modal__panel modal__panel--form">
        <!-- Overlay для блокировки формы -->
        <div id="form-overlay" class="modal__overlay" style="display: none">
          <div class="modal__overlay-content">
            <div class="spinner"></div>
            <p>Сохранение...</p>
          </div>
        </div>

        <button class="modal__close" id="modal-close" aria-label="Закрыть">
          ✕
        </button>
        <h2 class="modal__title" id="modal-title">Добавить игру</h2>

        <form id="game-form" class="form" autocomplete="off">
          <input type="hidden" id="game-id" />

          <div class="form__content">
            <div class="form__fields">
              <div class="form__row">
                <label for="title" class="form__label">
                  Название <span class="form__required">*</span>
                </label>
                <input
                  id="title"
                  type="text"
                  class="form__input"
                  required
                  placeholder="Введите название игры"
                />
                <!-- Контейнер для всплывающего уведомления о дублях -->
                <div id="duplicate-popup" class="duplicate-popup"></div>
              </div>

              <div class="form__grid form__grid--3cols">
                <div class="form__field">
                  <label for="version" class="form__label--small">Версия</label>
                  <input
                    id="version"
                    type="text"
                    class="form__input"
                    placeholder="например, GOTY или 1.2.3"
                  />
                </div>

                <div class="form__field">
                  <label for="rating" class="form__label--small">Оценка</label>
                  <input
                    id="rating"
                    type="number"
                    class="form__input"
                    min="0"
                    max="10"
                    step="0.1"
                    value="0"
                  />
                </div>

                <div class="form__field">
                  <label for="status" class="form__label--small">Статус</label>
                  <select id="status" class="form__select">
                    <option value="playing">Играю</option>
                    <option value="planned">В планах</option>
                    <option value="completed">Прошёл</option>
                    <option value="dropped">Дропнул</option>
                  </select>
                </div>
              </div>

              <div class="form__row">
                <label for="game-link" class="form__label"
                  >Ссылка на игру</label
                >
                <input
                  id="game-link"
                  type="text"
                  class="form__input"
                  placeholder="https://..."
                />
              </div>

              <div class="form__row form__row--grow">
                <label for="review" class="form__label">Отзыв</label>
                <textarea
                  id="review"
                  class="form__textarea"
                  rows="5"
                  placeholder="Коротко о впечатлениях"
                ></textarea>
              </div>
            </div>

            <div class="form__upload">
              <div class="upload-area" id="upload-area">
                <div
                  id="screenshot-preview"
                  class="upload-area__preview upload-area__preview--empty"
                ></div>
                <input
                  id="screenshot"
                  type="file"
                  accept="image/*"
                  class="upload-area__input"
                />
              </div>
              <button
                id="remove-screenshot"
                type="button"
                class="btn btn--secondary btn--small hidden"
              >
                Удалить изображение
              </button>
              <div class="form__actions">
                <button id="cancel-btn" type="button" class="btn">
                  Отмена
                </button>
                <button id="save-btn" type="submit" class="btn btn--primary">
                  Добавить
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- Модальное окно просмотра -->
    <div id="view-modal" class="modal" aria-hidden="true">
      <div class="modal__panel modal__panel--view">
        <button class="modal__close" id="view-close" aria-label="Закрыть">
          ✕
        </button>

        <div class="view">
          <div class="view__left">
            <div class="view__rating" id="view-rating">★ 0.0</div>
            <div class="view__image-wrap">
              <div class="view__image" id="view-image"></div>
            </div>
          </div>

          <div class="view__right">
            <div class="view__header">
              <h3 class="view__title" id="view-title"></h3>
              <button
                class="view__copy"
                id="view-copy-title"
                aria-label="Копировать название"
              >
                ⧉
              </button>
            </div>

            <div class="view__meta">
              <div class="view__version" id="view-version">Версия: —</div>
              <div class="status-badge" id="view-status"></div>
            </div>

            <div class="view__review">
              <div class="view__review-content" id="view-review"></div>
            </div>

            <div class="view__footer">
              <div class="view__dates">
                <span id="view-created-at" class="view__date">Создано: —</span>
                <span id="view-updated-at" class="view__date"
                  >Обновлено: —</span
                >
              </div>
              <div class="view__actions">
                <button id="view-edit" class="btn">Редактировать</button>
                <button id="view-delete" class="btn btn--danger">
                  Удалить
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Модальное окно подтверждения -->
    <div id="confirm-modal" class="modal" aria-hidden="true">
      <div class="modal__panel modal__panel--small">
        <h3 class="modal__title">Подтвердите удаление</h3>
        <p class="modal__text">Удалить карточку игры?</p>
        <div class="modal__actions">
          <button id="confirm-cancel" class="btn">Отмена</button>
          <button id="confirm-delete" class="btn btn--danger">Удалить</button>
        </div>
      </div>
    </div>

    <script src="/eel.js"></script>
    <script type="module" src="app.js"></script>
  </body>
</html>
